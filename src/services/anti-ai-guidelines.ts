/**
 * 增强版去AI化写作指南
 *
 * 基于行业研究优化，解决AI写作的典型问题：
 * 1. 句式单调
 * 2. 词汇重复
 * 3. 情感空洞
 * 4. 结构模板化
 */

/**
 * 基础去AI化指南（已在 chapter-writer.ts 中使用）
 */
export const BASIC_ANTI_AI_GUIDELINES = `
【严禁的AI写作痕迹】

1. 禁止任何形式的总结和升华：
   ❌ "这一战让他明白了..."
   ❌ "经此一役，他终于成长了"
   ❌ "他知道，这只是开始"
   ❌ "命运的齿轮开始转动"
   ✅ 正确做法：停在具体的动作、对话或场景上

2. 禁止AI式套话和过渡：
   ❌ "就这样"、"于是"、"总之"开头
   ❌ "就在这时"、"突然间"、"霎时间"
   ❌ "不知过了多久"、"时间一分一秒过去"
   ❌ "深吸一口气"（每章都出现）
   ✅ 正确做法：直接写动作，省略过渡词

3. 禁止抽象和模糊的描写：
   ❌ "仿佛"、"似乎"、"宛如"过度使用
   ❌ "难以言喻的感觉"、"莫名的情绪"
   ❌ "说不出的压迫感"、"无法形容的..."
   ✅ 正确做法：写具体的感官细节
`

/**
 * 进阶去AI化指南（新增）
 */
export const ENHANCED_ANTI_AI_GUIDELINES = `
【进阶】去AI化增强指南

一、句式变化要求
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 长短句比例控制：
   - 长句（20字以上）与短句（10字以下）比例约 3:1
   - 每5句至少有1句是短句或对话
   - 紧张场面：短句为主，每句5-10字
   - 描写场面：中等句长，每句15-25字

2. 禁止连续相同句式：
   ❌ 连续3句以上 "他xxx。他xxx。他xxx。"
   ❌ 连续使用 "只见..." "只听..." 开头
   ❌ 连续使用被动句式

3. 句首变化规则：
   - 禁止连续2句以上 "他/她" 开头
   - 禁止使用 "这时" "此时" "这一刻" 开头
   - 禁止使用 "只见" "但见" 开头
   ✅ 变化方式：以动作开头、以对话开头、以环境开头

二、词汇禁用增补清单
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【时间过渡词 - 禁用】
"一时间"、"刹那间"、"瞬间"、"霎时"
→ 改用：直接写动作，不用时间词过渡

【陈词滥调 - 禁用】
"目光如炬"、"身形一晃"、"眼中精光一闪"
"心中一动"、"脑海中闪过"、"暗暗想道"
"冷冷一笑"、"淡淡道"、"缓缓开口"
→ 改用：具体的表情和动作描写

【空洞形容 - 禁用】
"一股强大的气息"、"一道身影"、"一阵风"
"前所未有"、"难以置信"、"不可思议"
→ 改用：具体的感官细节

【心理描写滥用 - 禁用】
"他心想"、"他暗道"、"他不禁想到"
→ 改用：通过行为展现心理，限制内心独白不超过2句

三、描写技巧升级
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 用动词代替形容词：
   ❌ "美丽的花" → ✅ "花瓣微颤"
   ❌ "巨大的压力" → ✅ "压得他喘不过气"
   ❌ "愤怒的表情" → ✅ "他的嘴角抽搐"

2. 用具体代替抽象：
   ❌ "很痛" → ✅ "痛得指甲掐入掌心"
   ❌ "很紧张" → ✅ "他攥紧了袖口"
   ❌ "很害怕" → ✅ "他的手在发抖"

3. 用行为代替心理：
   ❌ "他很高兴" → ✅ "他嘴角上扬"
   ❌ "她很伤心" → ✅ "她转过身去，不让人看见她的眼睛"
   ❌ "他下定决心" → ✅ "他站了起来"

四、对话写作规范
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 对话必须体现角色个性：
   - 每个角色应有独特的说话方式
   - 用词、句式、语气要符合角色身份
   - 避免所有角色说话方式相同

2. 禁止乒乓式对话：
   ❌ "你好吗？" "我很好。" "那就好。" "嗯。"
   ✅ 对话中穿插动作、神态、环境描写

3. 对话标签简化：
   ❌ "他咬牙切齿地说道，眼中充满愤怒"
   ✅ "他说" 或直接省略说话人（上下文清晰时）

4. 对话长度控制：
   - 单次对话不超过3句
   - 连续对话不超过3轮不穿插描写
   - 演讲/解释性对话要打断，加入听者反应

五、场景描写五感法
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

根据场景类型选择重点感官：

【战斗场景】
- 视觉：动作轨迹、血迹、光影
- 听觉：金属碰撞、呼吸声、风声
- 触觉：冲击力、疼痛、疲劳

【情感场景】
- 视觉：微表情、眼神、姿态
- 触觉：温度、触感
- 听觉：声音的微妙变化

【悬疑场景】
- 视觉：阴影、模糊的轮廓
- 听觉：异响、沉默
- 嗅觉：异味、熟悉的气味

描写原则：
- 用具体的感官细节代替抽象形容词
- 通过环境暗示人物心理
- 细节要与情节发展相关，不做无用堆砌
- 每个场景选择2-3个重点感官，不堆砌全部

六、节奏控制指南
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【紧张/战斗场面】
- 句子：短句为主，5-15字
- 段落：1-3句一段
- 动作：连续、快速、省略过渡
- 对话：简短有力，不超过一句
示例："他闪身避开。剑光擦过他的脸颊。他反手一刺。"

【日常/过渡场面】
- 句子：中等长度，15-30字
- 段落：3-5句一段
- 节奏：轻松自然
- 对话：可以稍长，但不冗长

【情感/高潮场面】
- 句子：长短结合，营造张力
- 描写：可以放慢，增加细节
- 空白：善用沉默和留白
- 结尾：戛然而止，不解释

【断章要求】
- 停在动作的一半
- 停在意外出现时
- 停在对话前半句
- 绝对不加任何解释、评论、暗示
`

/**
 * 深度心理描写模板
 */
export const PSYCHOLOGICAL_DEPTH_PROMPTS = {
  // 内心冲突描写
  innerConflict: `
描写内心冲突时：
1. 不要直接说"他很矛盾"
2. 通过行为犹豫展现：伸出的手停在半空
3. 通过生理反应展现：心跳加速、手心出汗
4. 通过内心独白展现：以角色的口吻自问自答
5. 限制在2-3句，点到为止
`,

  // 情感爆发描写
  emotionalOutburst: `
描写情感爆发时：
1. 先有压抑的铺垫
2. 爆发的瞬间用短句
3. 用身体语言代替语言
4. 环境可以呼应情绪（天气、光线等）
5. 爆发后留有余韵
`,

  // 微妙情感描写
  subtleEmotion: `
描写微妙情感时：
1. 用细节暗示：一个眼神、一个动作
2. 用对话潜台词：说的和想的不一样
3. 用沉默：有时不说比说更有力
4. 用环境映射：借景抒情
5. 不要解释，让读者自己感受
`
}

/**
 * 获取完整的去AI化指南
 */
export function getFullAntiAIGuidelines(): string {
  return BASIC_ANTI_AI_GUIDELINES + '\n\n' + ENHANCED_ANTI_AI_GUIDELINES
}

/**
 * 根据场景类型获取针对性指南
 */
export function getSceneSpecificGuidelines(sceneType: 'battle' | 'emotion' | 'daily' | 'mystery'): string {
  const guidelines: Record<string, string> = {
    battle: `
【战斗场景专用指南】
- 短句为主，每句5-15字
- 动作清晰，避免"一片混乱"
- 用声音词增强画面感
- 每个动作都有后果
- 受伤要具体：部位、程度
- 战斗中对话极简
`,
    emotion: `
【情感场景专用指南】
- 用细节展现情绪，不直接说
- 善用沉默和停顿
- 环境可以映射心理
- 对话要有潜台词
- 眼神和小动作很重要
- 结尾不要解释
`,
    daily: `
【日常场景专用指南】
- 节奏轻松但不拖沓
- 对话自然口语化
- 可以有幽默元素
- 细节增加真实感
- 推进剧情或塑造人物
- 不要写流水账
`,
    mystery: `
【悬疑场景专用指南】
- 营造氛围，不直接说"恐怖"
- 用声音和阴影增强悬疑
- 信息逐步释放
- 留下疑点不解答
- 结尾制造悬念
- 避免过度解释
`
  }

  return guidelines[sceneType] || ''
}

/**
 * 生成自检清单
 */
export function generateSelfCheckList(): string {
  return `
【写完后自查清单】
□ 没有"就这样"、"于是"、"总之"等AI套话
□ 没有"眼中闪过"、"深吸一口气"等AI惯用句
□ 没有结尾总结或升华
□ 没有连续3句以上相同句式
□ 对话简洁自然，有角色特色
□ 描写具体不抽象
□ 严格遵循大纲
□ 字数适中不注水
□ 长短句有变化
□ 章末是动作/对话/场景，不是感悟
`
}
